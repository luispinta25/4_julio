<div class="module-header">
    <h2 class="module-title">Gestión de Lotes</h2>
    <div class="header-actions">
        <button id="btn-nuevo-lote" class="btn btn-primary">
            <i class="fas fa-plus"></i> Nuevo Lote
        </button>
    </div>
</div>

<!-- Stats Row -->
<div class="stats-grid">
    <div class="stat-card cursor-pointer" id="card-total-lotes">
        <div class="stat-icon icon-blue">
            <i class="fas fa-layer-group"></i>
        </div>
        <div class="stat-info">
            <span class="stat-label">Total Lotes</span>
            <span class="stat-value" id="total-lotes">...</span>
        </div>
    </div>
    <div class="stat-card cursor-pointer" id="card-lotes-sin-socio">
        <div class="stat-icon icon-red">
            <i class="fas fa-user-slash"></i>
        </div>
        <div class="stat-info">
            <span class="stat-label">Lotes sin Socio</span>
            <span class="stat-value" id="lotes-sin-socio">...</span>
        </div>
    </div>
    <div class="stat-card cursor-pointer" id="card-lotes-promesa">
        <div class="stat-icon icon-green">
            <i class="fas fa-file-contract"></i>
        </div>
        <div class="stat-info">
            <span class="stat-label">Promesa Firmada</span>
            <span class="stat-value" id="lotes-promesa">...</span>
        </div>
    </div>
    <div class="stat-card cursor-pointer" id="card-lotes-incomplete">
        <div class="stat-icon icon-yellow">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <div class="stat-info">
            <span class="stat-label">Datos Incompletos</span>
            <span class="stat-value" id="lotes-incomplete">...</span>
        </div>
    </div>
</div>

<!-- Filters -->
<div class="filters-bar">
    <div class="search-wrapper">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="search-lotes" class="search-input" placeholder="Buscar por lote, socio o cédula...">
    </div>
    <div class="filter-group">
        <select id="filter-lote-etapa" class="filter-select">
            <option value="all">Todas las Etapas</option>
            <option value="1">Etapa 1 (Verde)</option>
            <option value="2">Etapa 2 (Rojo)</option>
            <option value="3">Etapa 3 (Café)</option>
        </select>
        <select id="filter-lote-estado" class="filter-select">
            <option value="all">Todos los Estados</option>
            <option value="ok">Datos Completos</option>
            <option value="update">Requiere Actualización</option>
        </select>
    </div>
</div>

<!-- Table -->
<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Lote / Etapa</th>
                <th>Socio (Dueño)</th>
                <th>Contacto Registrado</th>
                <th>Promesa</th>
                <th>Estado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="lotes-table-body">
            <tr>
                <td colspan="6" class="text-center p-4">Cargando datos...</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Modal para Nuevo/Editar Lote -->
<div id="modal-lote" class="modal hidden">
    <div class="modal-backdrop" onclick="document.getElementById('modal-lote').classList.add('hidden')"></div>
    <div class="modal-card" style="max-width: 550px;">
        <div class="modal-header">
            <div class="modal-title-group">
                <div class="modal-title" id="modal-lote-title">Registrar Nuevo Lote</div>
                <div class="modal-subtitle">Asignación de socio y datos de contacto</div>
            </div>
            <button class="modal-close" id="close-modal-lote">&times;</button>
        </div>
        <div class="modal-body">
            <form id="form-lote">
                <input type="hidden" id="lote-id-hidden">
                
                <div class="grid grid-cols-2 gap-4">
                    <div class="form-field">
                        <label class="form-label">Etapa</label>
                        <select id="lote-etapa" class="form-input" required>
                            <option value="1">Etapa 1 (Verde)</option>
                            <option value="2">Etapa 2 (Rojo)</option>
                            <option value="3">Etapa 3 (Café)</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label class="form-label">Número de Lote</label>
                        <input id="lote-numero" class="form-input" type="number" placeholder="Ej: 15" required />
                    </div>

                    <div class="form-field col-span-2">
                        <label class="form-label">Socio Propietario</label>
                        <select id="lote-socio" class="form-input">
                            <option value="">-- Sin Socio (Disponible) --</option>
                            <!-- Se llena dinámicamente -->
                        </select>
                        <p class="text-xs text-muted mt-1">Al cambiar de socio, el sistema registrará automáticamente el traspaso en el historial.</p>
                    </div>

                    <div class="form-field">
                        <label class="form-label">Celular de Contacto</label>
                        <input id="lote-celular" class="form-input" type="text" placeholder="Ej: 0999999999" />
                    </div>

                    <div class="form-field">
                        <label class="form-label">Correo Electrónico</label>
                        <input id="lote-correo" class="form-input" type="email" placeholder="correo@ejemplo.com" />
                    </div>

                    <div class="form-field col-span-2">
                        <label class="form-label">¿Posee Promesa Firmada?</label>
                        <select id="lote-promesa" class="form-input">
                            <option value="NO">NO</option>
                            <option value="SI">SÍ</option>
                        </select>
                    </div>
                </div>

                <div id="lote-msg" class="helper-text hidden"></div>

                <div class="modal-footer mt-6">
                    <button type="button" id="btn-cancelar-lote" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Lote</button>
                </div>
            </form>
        </div>
    </div>
</div>
